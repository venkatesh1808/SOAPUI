<?xml version="1.0" encoding="UTF-8"?>
<con:soapui-project id="58e945fa-d387-461b-ab04-d5a14376e00e" activeEnvironment="Default" name="REST Project 2" resourceRoot="" soapui-version="5.5.0" abortOnError="false" runType="SEQUENTIAL" xmlns:con="http://eviware.com/soapui/config"><con:settings/><con:interface xsi:type="con:RestService" id="35e59c6c-3514-4f3f-932f-c4ae03c5e47f" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://thetestingworldapi.com" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>http://thetestingworldapi.com</con:endpoint></con:endpoints><con:resource name="StudentsDetails" path="/api/studentsDetails" id="f27aba14-f86b-4d98-b240-9e7f0d4bc856"><con:settings/><con:parameters/><con:method name="StudentsDetails 1" id="20a7c676-5e9f-48a1-8a2f-4f6c4dc2f9b6" method="POST"><con:settings/><con:parameters/><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>201</con:status><con:params/><con:element xmlns:stud="http://thetestingworldapi.com/api/studentsDetails">stud:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="9162ee11-502e-49b8-99f2-11747ed8d031" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request>{
  "id": 1067,
  "first_name": "Ram",
  "middle_name": "Son",
  "last_name": "Carl",
  "date_of_birth": "18-08-1990"
}</con:request><con:originalUri>http://thetestingworldapi.com/api/studentsDetails</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="4f3c51a4-70ec-4f61-92c1-0c4a1a7363a9" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://thetestingworldapi.com" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://thetestingworldapi.com</con:endpoint></con:endpoints><con:resource name="Id" path="/api/studentsDetails/{id}" id="0552a814-fa6e-464a-aad1-232ef022f34a"><con:settings/><con:parameters><con:parameter><con:name>id</con:name><con:value>id</con:value><con:style>TEMPLATE</con:style><con:default>id</con:default><con:path xsi:nil="true"/><con:description xsi:nil="true"/></con:parameter></con:parameters><con:method name="Id 1" id="1e7029bd-599a-46c6-817e-804759cdb0e9" method="PUT"><con:settings/><con:parameters/><con:representation type="FAULT"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>500</con:status><con:params/><con:element xmlns:ns="http://thetestingworldapi.com/api/studentsDetails/176312">ns:Fault</con:element></con:representation><con:representation type="REQUEST"><con:mediaType>application/json</con:mediaType><con:params/></con:representation><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ns="http://thetestingworldapi.com/api/studentsDetails/176312">ns:Response</con:element></con:representation><con:representation type="RESPONSE"><con:mediaType xsi:nil="true"/><con:status>0</con:status><con:params/><con:element>data</con:element></con:representation><con:request name="Request 1" id="b4419670-b9b9-477b-849c-0d931fcdc1c4" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request>{
    "id": 176309,
    "first_name": "Ram",
    "middle_name": "Singh",
    "last_name": "Carl",
    "date_of_birth": "18-08-1990"
}</con:request><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="id" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="3bb9ba9d-851f-4118-ad95-138022307b98" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://thetestingworldapi.com" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache type="TEXT" rootPart=""/><con:endpoints><con:endpoint>http://thetestingworldapi.com</con:endpoint></con:endpoints><con:resource name="Id" path="/api/studentsDetails/{id1}" id="00bc7050-59e6-4ea0-bfea-b9d14d6bf0e9"><con:settings/><con:parameters><con:parameter><con:name>id1</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Id 1" id="89d39a6a-06b8-435f-8e97-d180171b57ad" method="GET"><con:settings/><con:parameters/><con:representation type="RESPONSE"><con:mediaType>application/json; charset=utf-8</con:mediaType><con:status>200</con:status><con:params/><con:element xmlns:ns="http://thetestingworldapi.com/api/studentsDetails/176556">ns:Response</con:element></con:representation><con:request name="Request 1" id="7c144aab-9dd1-4c33-ab0d-c126ac1ae5a2" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id1" value="1" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id1</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:interface xsi:type="con:RestService" id="455082f7-bccd-4a7f-a104-9bee14fdd0af" wadlVersion="http://wadl.dev.java.net/2009/02" name="http://thetestingworldapi.com" type="rest" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:settings/><con:definitionCache/><con:endpoints><con:endpoint>http://DESKTOP-3JA1JS6:8080/</con:endpoint><con:endpoint>http://thetestingworldapi.com</con:endpoint></con:endpoints><con:resource name="Id" path="/api/studentsDetails/{id2}" id="9c9e5bc0-8ccd-4195-bbd2-1a104407eb83"><con:settings/><con:parameters><con:parameter><con:name>id2</con:name><con:value>1</con:value><con:style>TEMPLATE</con:style><con:default>1</con:default></con:parameter></con:parameters><con:method name="Id 1" id="b8b1851a-8c24-4c16-97b8-16822ad3cd70" method="DELETE"><con:settings/><con:parameters/><con:request name="Request 1" id="b7a4efec-7d9f-44f8-a99b-ade6dca87657" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request/><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id2" value="1" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id2</con:entry></con:parameterOrder></con:request></con:method></con:resource></con:interface><con:testSuite id="24e102e9-d320-4d0d-bec5-ffe88a607461" name="TestSuite 1"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase id="f5c3e3f8-d28c-415b-9e40-94cc5a0de679" failOnError="true" failTestCaseOnErrors="true" keepSession="false" maxResults="0" name="TestCase 1" searchProperties="true"><con:description>To create, udate and view the student detail.</con:description><con:settings/><con:testStep type="properties" name="Properties" id="dcd10337-0ead-47ab-870e-026ad33984a5"><con:settings/><con:config xsi:type="con:PropertiesStep" saveFirst="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:properties><con:property><con:name>first_name</con:name><con:value>Derik</con:value></con:property><con:property><con:name>middle_name</con:name><con:value>John</con:value></con:property><con:property><con:name>last_name</con:name><con:value>Monk</con:value></con:property><con:property><con:name>date_of_birth</con:name><con:value>18-08-1990</con:value></con:property><con:property><con:name>new_id</con:name><con:value>176629</con:value></con:property><con:property><con:name>newFirstName</con:name><con:value>Goel</con:value></con:property><con:property><con:name>newMiddleName</con:name><con:value>Jose</con:value></con:property><con:property><con:name>newLastName</con:name><con:value>Abu</con:value></con:property><con:property><con:name>newDob</con:name><con:value>19-06-1996</con:value></con:property></con:properties></con:config></con:testStep><con:testStep type="restrequest" name="Create" id="9bd39f46-f589-4e8b-9ae8-7ee9c3a844e4"><con:settings/><con:config service="http://thetestingworldapi.com" resourcePath="/api/studentsDetails" methodName="StudentsDetails 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Create" id="9162ee11-502e-49b8-99f2-11747ed8d031" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request>{
  "id": 1067,
  "first_name": "${first_name}",
  "middle_name": "${middle_name}",
  "last_name": "${last_name}",
  "date_of_birth": "${date_of_birth}"
}</con:request><con:originalUri>http://thetestingworldapi.com/api/studentsDetails</con:originalUri><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters/></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="Update" id="2759f81a-e7c1-4522-bb90-6933d4dd5c94"><con:settings/><con:config service="http://thetestingworldapi.com" resourcePath="/api/studentsDetails/{id}" methodName="Id 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="Update" id="b4419670-b9b9-477b-849c-0d931fcdc1c4" mediaType="application/json" postQueryString="false"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request>{
    "id": ${new_id},
    "first_name": "${newFirstName}",
    "middle_name": "${newMiddleName}",
    "last_name": "${newLastName}",
    "date_of_birth": "${newDob}"
}</con:request><con:originalUri>http://thetestingworldapi.com/api/studentsDetails/176312</con:originalUri><con:assertion type="JsonPath Match" id="4d5e209e-9db0-4812-8b78-8a686498132e" name="JsonPath Match"><con:configuration><path>$status</path><content>true</content><allowWildcards>false</allowWildcards><ignoreNamspaceDifferences>false</ignoreNamspaceDifferences><ignoreComments>false</ignoreComments></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id" value="${new_id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="restrequest" name="View" id="9b0fbbd0-bb43-4ef0-94d5-be692d9087c2"><con:settings/><con:config service="http://thetestingworldapi.com" resourcePath="/api/studentsDetails/{id1}" methodName="Id 1" xsi:type="con:RestRequestStep" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"><con:restRequest name="View" id="7c144aab-9dd1-4c33-ab0d-c126ac1ae5a2" mediaType="application/json"><con:settings><con:setting id="com.eviware.soapui.impl.support.AbstractHttpRequest@follow-redirects">true</con:setting><con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/></con:setting></con:settings><con:endpoint>http://thetestingworldapi.com</con:endpoint><con:request/><con:originalUri>http://thetestingworldapi.com/api/studentsDetails/176556</con:originalUri><con:assertion type="Simple Contains" id="2bccae88-9626-4498-a3fd-5b38b8864ec8" name="Contains"><con:configuration><token>Goel</token><ignoreCase>false</ignoreCase><useRegEx>false</useRegEx></con:configuration></con:assertion><con:credentials><con:authType>No Authorization</con:authType></con:credentials><con:jmsConfig JMSDeliveryMode="PERSISTENT"/><con:jmsPropertyConfig/><con:parameters><entry key="id1" value="${new_id}" xmlns="http://eviware.com/soapui/config"/></con:parameters><con:parameterOrder><con:entry>id1</con:entry></con:parameterOrder></con:restRequest></con:config></con:testStep><con:testStep type="groovy" name="Groovy Script" id="fbe756ed-bbe3-4c34-bb3c-7f9ad48636b7"><con:settings/><con:config><script>import jxl.*
import jxl.write.*
import jxl.read.biff.BiffException
import java.util.*
import groovy.json.*

//import groovy utilities
def groovyUtils = new com.eviware.soapui.support.GroovyUtils(context)
Workbook vb = Workbook.getWorkbook(new File("E:\\SOAP\\Students.xls"));
Sheet sh = vb.getSheet("Create")
rc=sh.getRows()
cc=sh.getColumns()

ArrayList&lt;String> Data = new ArrayList&lt;String>()
for(int i=1; i&lt;2; i++)
{
	for(j=1; j&lt;cc; j++)
	{
		def CellValue = sh.getCell(j,i)
		Request = CellValue.getContents()
		if(!Request.equals(" "))
		{
			Data.add(Request)
			log.info Request
		}
	}
}


//testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "id", Data[0] )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "first_name", Data[0] )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "middle_name", Data[1] )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "last_name", Data[2] )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "date_of_birth", Data[3] )

testRunner.runTestStepByName("Create")

def responseCreate = testRunner.testCase.getTestStepByName("Create").getPropertyValue("response")
def responseJSON1 = new JsonSlurper().parseText(responseCreate)

def getID = responseJSON1.id
String str_getID = getID

testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "new_id", str_getID )

String newFirstName = "Goel"
String newMiddleName = "Jose"
String newLastName = "Abu"
String newDob = "19-06-1996"

testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "newFirstName", newFirstName )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "newMiddleName", newMiddleName )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "newLastName", newLastName )
testRunner.testCase.getTestStepByName("Properties").setPropertyValue( "newDob", newDob )

testRunner.runTestStepByName("Update")

def responseUpdate = testRunner.testCase.getTestStepByName("Update").getPropertyValue("response")
def responseJSON2 = new JsonSlurper().parseText(responseUpdate)

def msg = responseJSON2.msg
log.info msg

log.info "Updated successfully"

testRunner.runTestStepByName("View")

def responseView = testRunner.testCase.getTestStepByName("View").getPropertyValue("response")
def responseJSON3 = new JsonSlurper().parseText(responseView)


def firstName = responseJSON3.data.first_name
log.info firstName
def middleName = responseJSON3.data.middle_name
log.info middleName
def lastName = responseJSON3.data.last_name
log.info lastName
def dob = responseJSON3.data.date_of_birth
log.info dob

File f1 = new File("E:\\SOAP\\Students.xls")
Workbook workbook1 = Workbook.getWorkbook(f1)
WritableWorkbook wb = Workbook.createWorkbook(f1,workbook1)
WritableSheet ws1 = wb.getSheet("View")

Label l1 = new Label(1,1,str_getID)
ws1.addCell(l1)

Label l2 = new Label(2,1,firstName)
ws1.addCell(l2)

Label l3 = new Label(3,1,middleName)
ws1.addCell(l3)

Label l4 = new Label(4,1,lastName)
ws1.addCell(l4)

Label l5 = new Label(5,1,dob)
ws1.addCell(l5)

wb.write()
wb.close()

//testRunner.runTestStepByName("Delete")

//log.info "Deleted successfully"

</script></con:config></con:testStep><con:properties/></con:testCase><con:properties/></con:testSuite><con:restMockService id="51cbca7b-9b61-4cbc-b183-cf9258ed12e8" port="8080" path="/" host="DESKTOP-3JA1JS6" name="Delete"><con:settings/><con:properties/><con:restMockAction name="/api/studentsDetails/id" method="DELETE" resourcePath="/api/studentsDetails/id" id="2aa12688-7da8-4320-a7ae-382845e3f0c0"><con:settings/><con:defaultResponse>Response 1</con:defaultResponse><con:dispatchStyle>SEQUENCE</con:dispatchStyle><con:dispatchPath>/*
// Script dispatcher is used to select a response based on the incoming request.
// Here are few examples showing how to match based on path, query param, header and body

// Match based on path
def requestPath = mockRequest.getPath()
log.info "Path: "+ requestPath

if( requestPath.contains("json") )
{
    // return the name of the response you want to dispatch
    return "JSON Response"
}


// Match based on query parameter
def queryString = mockRequest.getRequest().getQueryString()
log.info "QueryString: " + queryString

if( queryString.contains("stockholm") )
{
    // return the name of the response you want to dispatch
    return "Response Stockholm"
}
else if( queryString.contains("london") )
{
    // return the name of the response you want to dispatch
    return "Response London"
}


// Match based on header
def acceptEncodingHeaderList = mockRequest.getRequestHeaders().get("Accept-Encoding")
log.info "AcceptEncoding Header List: " + acceptEncodingHeaderList

if( acceptEncodingHeaderList.contains("gzip,deflate") )
{
    // return the name of the response you want to dispatch
    return "GZiped Response"
}


// Match based on body
def requestBody = mockRequest.getRequestContent()
log.info "Request body: " + requestBody

if( requestBody.contains("some data") )
{
    // return the name of the response you want to dispatch
    return "Response N"
}
*/
</con:dispatchPath><con:response name="Response 1" id="bf8b13ca-4196-4beb-8b26-1eebfdd61f1a" httpResponseStatus="200"><con:settings/></con:response></con:restMockAction></con:restMockService><con:properties/><con:wssContainer/><con:oAuth2ProfileContainer/><con:oAuth1ProfileContainer/><con:sensitiveInformation/></con:soapui-project>